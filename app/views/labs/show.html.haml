- unless @env.nil?
  .alert{ :class => "alert bg-info fadeout" }
    %button.close{ :data => { :dismiss => "alert" } } x
    .time= "The lab #{@env.template.title} is currently checked out to you"
    .time= "This lab will expire in #{time_ago_in_words(@env.expiration)}"
    - if @env.expiration < DateTime.now
      - throw Exception

.panel.panel-default
  .panel-heading
    = @lab.title

  .panel-body

    .env_description= @lab.description

    -if @env
      #panel_for_environment
        #access_panel
          #rdp.pull-left= link_to 'Connect via RDP', lab_rdp_path(@env), class: 'btn btn-primary'
          #smartclient.pull-left= link_to 'Connect via SmartClient', @env.published_url, target: '_blank', class: 'btn btn-primary'
          #delete.pull-right= link_to 'Delete Lab', delete_lab_path, method: :delete, class: 'btn btn-default', confirm: "This will delete the Lab and any work done while it has been running.\n Would you like to continue?"
    - unless @env

      .btn.btn-primary.spin_button.pull-left
        .create_env.pull-left{id: @lab.id} Create Environment
        .placeholder{style: 'visibility:hidden'} Create Environment
      %h5.patient.pull-right
        Please be patient while we spin up your lab.  This process can take several minutes.

      #loading.pull-left{style: 'display:none'}
        .spinner
          .inner
          .outer
      #timeout
        %h4.alert.alert-danger{role: 'alert'} <strong>The requested environment could not be created.</strong> Please contact the system administrator for help resolving this matter
= render partial: ('lab_credentials'), locals: {lab: @lab}
= render partial: ('lab_properties'), locals: {lab: @lab}
:javascript
   env_id = "#{@env.id unless @env.nil?}"
   create_lab_path = "#{create_lab_path(@lab)}"
